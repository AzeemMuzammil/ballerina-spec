# Consolidator bal tool

## Summary
Ballerina inherently supports microservices-style deployments, which are well-suited for microservice orchestration platforms like Kubernetes. However, many enterprise users deploy on VMs or Docker, where managing each service as a separate process increases complexity and resource overhead. This proposal aims to provide a solution tailored to such scenarios by enabling consolidated deployments. 

## Goals
* Allow multiple services to run as a single runtime process.
* Facilitate easy deployment in Docker-based and VM environments.
* Provide intuitive configuration through CLI options or a configuration file.

## Description
As mentioned above, the goal is to allow developers to specify services to consolidate into a single runtime process.

### Introducing the consolidate bal tool
This tool generates code required to group multiple services into one deployable artifact. 

The tool,
* Parses the Ballerina.toml file to identify the services to consolidate
* Generates a consolidated main.bal file with the shared listener and the service packages imported.
* Builds a single deployment artifact (e.g., .jar or Docker image) containing all the services.

### Features

Developers can create a consolidated package using the below command:
```bash
bal new -t ballerina/consolidate myConsolidatedPkg
```

This command creates a new Ballerina package with the consolidate tool added in the Ballerina.toml file as shown below. Developers can modify the values in the `options.services` with the actual services to consolidate.

```toml
[package]
org = "myOrg"
name = "myConsolidatedPkg"
version = "0.1.0"

[[tool.consolidate]]
id = "consolidate1"
options.services = ["myOrg/svc1", "myOrg/svc2"]  # modify the values with the services to consolidate
```

A single deployment artifact can be generated by executing the below command:
```bash
bal build [--cloud]
```
